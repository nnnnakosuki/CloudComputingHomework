# 学生选课管理系统

这是一个基于前后端分离架构的学生选课管理系统，主要用于高校的课程选择、成绩管理、排课管理等功能。

## 项目简介

系统采用主流的企业级开发技术栈，后端使用Spring Boot框架，前端使用Vue 3框架，数据库使用MySQL。系统实现了完整的用户权限管理、课程管理、选课管理、成绩管理等核心功能。

系统支持三种用户角色：学生、教师和管理员。学生可以浏览课程、选择课程、查看成绩和课表；教师可以管理自己的课程、录入成绩、查看学生名单；管理员拥有系统的全部管理权限。

## 技术架构

### 后端技术栈

后端基于Spring Boot 2.7.18开发，主要技术组件包括：

- Spring Boot：应用框架，提供自动配置和快速开发能力
- Spring Security：安全框架，提供认证和授权功能
- MyBatis Plus 3.5.3：持久层框架，简化数据库操作
- JWT 0.11.5：JSON Web Token，用于无状态的用户认证
- Apache POI 5.2.3：用于Excel文件解析和处理
- MySQL 8.0：关系型数据库，存储系统数据
- Lombok：代码生成工具，减少样板代码

后端采用经典的三层架构：Controller层负责处理HTTP请求，Service层实现业务逻辑，Mapper层处理数据库操作。系统配置了JWT过滤器实现统一的身份认证，使用Spring Security进行方法级的权限控制。

### 前端技术栈

前端基于Vue 3开发，使用现代化的前端工程化工具，主要技术组件包括：

- Vue 3.3.4：渐进式JavaScript框架
- Vue Router 4.2.4：单页面应用路由管理器
- Pinia 2.1.6：状态管理库，替代Vuex
- Element Plus 2.3.8：基于Vue 3的组件库
- Axios 1.4.0：HTTP客户端库，用于API请求
- Vite 4.4.5：新一代前端构建工具

前端采用组件化开发方式，按角色划分页面模块。使用Vue Router实现路由管理，配置了路由守卫进行权限控制。使用Axios封装统一的HTTP请求，自动添加JWT Token。

## 主要功能模块

### 用户认证与授权

系统实现了基于JWT的用户认证机制。用户登录后，后端生成JWT Token返回给前端，前端将Token存储在本地状态中，后续请求自动携带Token。

后端配置了JWT过滤器，统一验证Token的有效性。同时使用Spring Security的@PreAuthorize注解实现方法级的权限控制，根据不同角色分配不同的访问权限。

### 学生功能模块

学生登录系统后，可以查看个人信息、浏览课程、选择课程、查看成绩和课表。

个人信息页面显示学生的基本信息，包括学号、姓名、专业、班级等。系统规定学生只能查看个人信息，不能进行修改操作。

课程浏览功能允许学生查看所有可选择的课程，包括课程名称、学分、课程类型、授课教师等信息。学生可以根据课程类型、开课院系等条件筛选课程。

选课功能支持学生在线选择课程。系统会自动校验选课条件，如课程容量是否已满、是否重复选课等。选课成功后等待管理员审核。

成绩查询功能支持学生查看已修课程的成绩。教师可以为每门课程设置成绩查询开放时段，学生只有在指定时间段内才能查看成绩详情。超出时段后，成绩自动隐藏。

### 教师功能模块

教师登录系统后，可以管理自己的课程、录入成绩、查看学生名单和课表。

课程管理功能允许教师查看自己所授课程的列表，包括课程信息、选课人数、开课学期等。

成绩录入功能支持两种方式：手动录入和批量导入。手动录入适合少量成绩的录入，教师可以直接在页面上输入分数。批量导入功能支持Excel和CSV格式的文件，教师可以一次性导入大量成绩数据。

系统内置了完整的数据校验机制，导入前会自动验证学号是否存在、课程是否匹配、分数是否在有效范围内等。对于不符合要求的数据，系统会跳过这些数据并给出详细的错误提示，不会影响其他有效数据的导入。

成绩查询时段设置功能允许教师为每门课程设置统一的成绩查询开放时间段。设置后，学生只能在指定时间段内查看成绩详情，超出时段后成绩自动隐藏。

### 管理员功能模块

管理员拥有系统的全部管理权限，包括学生管理、课程管理、开课计划管理、成绩审核、选课审核、排课管理、用户管理、角色管理等。

学生管理功能支持管理员的查询、新增、修改、删除学生信息操作。系统支持按学号、姓名、院系等条件查询学生，支持学籍状态的变更操作。

课程管理功能允许管理员维护课程信息，包括课程编号、课程名称、学分、课程类型等。管理员可以启用或禁用某门课程。

开课计划管理用于为每个学期创建开课计划，包括选择课程、指定教师、设置选课人数上限等。

成绩审核功能允许管理员审核教师录入的成绩，确保成绩数据的准确性。

选课审核功能用于审核学生的选课申请，对于不符合选课条件的学生可以驳回申请。

排课管理功能支持为每门课程安排上课时间、教室等信息。系统支持冲突检测，避免同一教室在同一时间安排多门课程。

调课管理用于处理上课时间和地点的临时调整，记录调课原因和审批流程。

系统管理功能包括用户管理、角色管理和数据字典管理。用户管理支持添加、修改、删除用户账号；角色管理用于管理系统角色和权限；数据字典管理维护系统的参考数据。

## 核心功能设计解释

### 1. 成绩上传功能

- 教师可通过系统界面上传成绩，支持两种方式：
  1. **手动录入**：教师在成绩录入页面直接输入单个成绩。
  2. **批量导入**：系统支持 Excel (.xls/.xlsx) 和 CSV 格式文件批量上传学生成绩。

- 上传流程：
  - 用户选择成绩文件。
  - 前端通过 FormData 将文件上传至后端接口。
  - 后端使用 Apache POI 解析 Excel，或其他库处理 CSV。
  - 后端对每条成绩数据进行校验，包括学号是否存在、课程对应性、成绩数值范围等。
  - 合格数据写入成绩表，不合格数据记录错误信息并返回提示。

### 2. 成绩解析设计

- 使用 Apache POI 5.2.3 库解析 Excel 文件。
- 解析过程：
  - 后端读取上传文件流，定位成绩列和学生学号列。
  - 逐行读取，解析对应字段。
  - 对数据进行格式和业务规则校验。
- 异常处理：
  - 文件格式错误或读取异常捕获统一处理，返回友好错误信息。
  - 数据不合法时跳过该条记录但继续导入其他正常记录。
- 导入完成后返回处理结果摘要，包括成功导入条数和错误详情。

### 3. 成绩时间段控制

- 系统中设置了成绩查询的**开放时间段**，控制学生可见成绩的时间范围。
- 设计：
  - 在成绩表中新增两个字段：`query_start_time` 和 `query_end_time`。
  - 教师/管理员可为每门课程设置该时间段。
- 查询时：
  - 后端检查当前时间是否在该时间段内。
  - 超出时段，接口返回隐藏成绩的提示，学生界面相应禁用查看功能。
- 该机制保证成绩信息在规定时间内安全、按需开放，符合教学管理需求。

---

## 数据库设计

系统数据库使用MySQL 8.0，主要包含以下数据表：

- sys_user：用户表，存储系统用户信息
- sys_role：角色表，定义系统角色
- sys_dict：数据字典表，存储系统配置数据
- student_info：学生信息表，存储学生详细信息
- student_status：学籍变动表，记录学生学籍变动历史
- course：课程表，存储课程基本信息
- course_schedule：开课计划表，记录每个学期的开课计划
- course_selection：选课记录表，记录学生的选课信息
- course_grade：成绩表，存储学生成绩信息
- class_schedule：排课表，记录课程的具体上课时间地点
- schedule_adjustment：调课记录表，记录调课申请和审批
- teaching_plan：教学计划表，存储专业的教学计划

数据库设计遵循第三范式，保证数据的一致性和完整性。所有表都配置了逻辑删除字段，支持软删除操作。关键字段建立了索引，提高查询性能。

## 开发环境配置

### 后端环境要求

- JDK 8或更高版本
- Maven 3.6或更高版本
- MySQL 8.0数据库

后端项目使用Maven管理依赖，在项目根目录执行以下命令启动：

```
cd backend
mvn spring-boot:run
```

默认端口为8080，可以在application.yml中修改。

### 前端环境要求

- Node.js 16或更高版本
- npm或yarn包管理器

前端项目使用npm管理依赖，在项目根目录执行以下命令安装依赖并启动：

```
cd frontend
npm install
npm run dev
```

默认端口为5173，Vite会自动配置。

### 数据库配置

创建数据库并执行初始化脚本：

```sql
mysql -u root -p
create database course_selection;
use course_selection;
source backend/src/main/resources/schema.sql;
source backend/src/main/resources/data.sql;
```

修改application.yml中的数据库连接配置，确保数据库地址、用户名、密码正确。

### 配置说明

后端配置文件application.yml中需要注意以下配置：

- 数据库连接信息：url、username、password
- JWT密钥：jwt.secret
- JWT过期时间：jwt.expiration
- 服务端口：server.port

前端的API地址配置在src/utils/request.js文件中，需要根据实际部署地址修改baseURL。

## 使用说明

### 学生使用流程

1. 登录系统，使用学号和密码登录
2. 查看个人信息，包括学号、姓名、专业等
3. 浏览课程，查看可选择的课程列表
4. 选择课程，确认后提交选课申请
5. 等待审核，管理员审核通过后选课成功
6. 查看课表，确认自己的上课安排
7. 成绩查询时间开放后查看成绩

### 教师使用流程

1. 登录系统，使用工号和密码登录
2. 查看我的课程，确认本学期授课课程
3. 查看学生名单，了解选课学生信息
4. 录入成绩，可以手动录入或导入文件
5. 设置成绩查询时段，控制学生查看成绩的时间
6. 查看课表，确认自己的上课安排

### 管理员使用流程

1. 登录系统，使用管理员账号登录
2. 管理学生信息，新增、修改、查询学生
3. 管理课程信息，维护课程基本信息
4. 管理开课计划，为每个学期安排课程
5. 审核选课申请，批准或驳回学生选课
6. 管理排课信息，安排上课时间和教室
7. 审核成绩，确保成绩数据准确性
8. 管理系统用户，维护用户账号信息

