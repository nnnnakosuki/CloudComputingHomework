import{s as V,r as n,k as Q,c as r,v as W,o as w,d as F,f as l,w as a,E as f,e as O,h as p,F as X,q as Y,x as Z,n as $,t as h,p as ee}from"./index-9b5da449.js";import{_ as le}from"./_plugin-vue_export-helper-c27b6911.js";function te(i){return V({url:"/dict",method:"get",params:i})}function ae(i){return V({url:"/dict",method:"post",data:i})}function oe(i,g){return V({url:`/dict/${i}`,method:"put",data:g})}function ue(i){return V({url:`/dict/${i}`,method:"delete"})}function re(){return V({url:"/dict/types",method:"get"})}const ne={class:"dict-container"},se={class:"card-header"},de={__name:"Dict",setup(i){const g=n(!1),T=n(!1),_=n(!1),k=n(!1),D=n(),z=n([]),U=n([]),c=n({keyword:"",dictType:""}),s=n({current:1,size:10,total:0}),o=n({dictType:"",dictLabel:"",dictValue:"",sortOrder:0,status:1,remark:""}),q={dictType:[{required:!0,message:"请输入字典类型",trigger:"blur"}],dictLabel:[{required:!0,message:"请输入字典标签",trigger:"blur"}],dictValue:[{required:!0,message:"请输入字典值",trigger:"blur"}]},m=async()=>{g.value=!0;try{const u=await te({current:s.value.current,size:s.value.size,...c.value});z.value=u.data.records,s.value.total=u.data.total}catch{f.error("加载字典列表失败")}finally{g.value=!1}},x=async()=>{try{const u=await re();U.value=u.data}catch{f.error("加载字典类型失败")}},E=()=>{c.value={keyword:"",dictType:""},s.value.current=1,m()},S=()=>{k.value=!1,o.value={dictType:"",dictLabel:"",dictValue:"",sortOrder:0,status:1,remark:""},_.value=!0},I=u=>{k.value=!0,o.value={...u},_.value=!0},M=async()=>{D.value&&await D.value.validate(async u=>{if(u){T.value=!0;try{k.value?(await oe(o.value.id,o.value),f.success("更新字典成功")):(await ae(o.value),f.success("添加字典成功")),_.value=!1,m(),x()}catch(e){f.error(e.message||"保存字典失败")}finally{T.value=!1}}})},N=async u=>{try{await ee.confirm("确定要删除该字典吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await ue(u),f.success("删除字典成功"),m(),x()}catch(e){e!=="cancel"&&f.error("删除字典失败")}};return Q(()=>{m(),x()}),(u,e)=>{const v=r("el-button"),b=r("el-input"),d=r("el-form-item"),C=r("el-option"),L=r("el-select"),B=r("el-form"),y=r("el-table-column"),A=r("el-tag"),R=r("el-table"),j=r("el-pagination"),P=r("el-card"),G=r("el-input-number"),H=r("el-dialog"),J=W("loading");return w(),F("div",ne,[l(P,null,{header:a(()=>[O("div",se,[e[13]||(e[13]=O("span",null,"数据字典",-1)),l(v,{type:"primary",onClick:S},{default:a(()=>[...e[12]||(e[12]=[p("添加字典",-1)])]),_:1})])]),default:a(()=>[l(B,{model:c.value,inline:"",class:"search-form"},{default:a(()=>[l(d,{label:"关键词"},{default:a(()=>[l(b,{modelValue:c.value.keyword,"onUpdate:modelValue":e[0]||(e[0]=t=>c.value.keyword=t),placeholder:"字典类型、标签或值",clearable:""},null,8,["modelValue"])]),_:1}),l(d,{label:"字典类型"},{default:a(()=>[l(L,{modelValue:c.value.dictType,"onUpdate:modelValue":e[1]||(e[1]=t=>c.value.dictType=t),placeholder:"选择字典类型",clearable:"",style:{width:"150px"}},{default:a(()=>[(w(!0),F(X,null,Y(U.value,t=>(w(),$(C,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,null,{default:a(()=>[l(v,{type:"primary",onClick:m},{default:a(()=>[...e[14]||(e[14]=[p("搜索",-1)])]),_:1}),l(v,{onClick:E},{default:a(()=>[...e[15]||(e[15]=[p("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),Z((w(),$(R,{data:z.value},{default:a(()=>[l(y,{prop:"dictType",label:"字典类型"}),l(y,{prop:"dictLabel",label:"字典标签"}),l(y,{prop:"dictValue",label:"字典值"}),l(y,{prop:"sortOrder",label:"排序"}),l(y,{prop:"status",label:"状态"},{default:a(({row:t})=>[l(A,{type:t.status===1?"success":"danger"},{default:a(()=>[p(h(t.statusText),1)]),_:2},1032,["type"])]),_:1}),l(y,{label:"操作"},{default:a(({row:t})=>[l(v,{type:"primary",size:"small",onClick:K=>I(t)},{default:a(()=>[...e[16]||(e[16]=[p("编辑",-1)])]),_:1},8,["onClick"]),l(v,{type:"danger",size:"small",onClick:K=>N(t.id)},{default:a(()=>[...e[17]||(e[17]=[p("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[J,g.value]]),l(j,{"current-page":s.value.current,"onUpdate:currentPage":e[2]||(e[2]=t=>s.value.current=t),"page-size":s.value.size,"onUpdate:pageSize":e[3]||(e[3]=t=>s.value.size=t),total:s.value.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:m,onCurrentChange:m,class:"pagination"},null,8,["current-page","page-size","total"])]),_:1}),l(H,{modelValue:_.value,"onUpdate:modelValue":e[11]||(e[11]=t=>_.value=t),title:k.value?"编辑字典":"添加字典",width:"500px"},{footer:a(()=>[l(v,{onClick:e[10]||(e[10]=t=>_.value=!1)},{default:a(()=>[...e[18]||(e[18]=[p("取消",-1)])]),_:1}),l(v,{type:"primary",onClick:M,loading:T.value},{default:a(()=>[...e[19]||(e[19]=[p("确定",-1)])]),_:1},8,["loading"])]),default:a(()=>[l(B,{model:o.value,rules:q,ref_key:"dictFormRef",ref:D,"label-width":"100px"},{default:a(()=>[l(d,{label:"字典类型",prop:"dictType"},{default:a(()=>[l(b,{modelValue:o.value.dictType,"onUpdate:modelValue":e[4]||(e[4]=t=>o.value.dictType=t)},null,8,["modelValue"])]),_:1}),l(d,{label:"字典标签",prop:"dictLabel"},{default:a(()=>[l(b,{modelValue:o.value.dictLabel,"onUpdate:modelValue":e[5]||(e[5]=t=>o.value.dictLabel=t)},null,8,["modelValue"])]),_:1}),l(d,{label:"字典值",prop:"dictValue"},{default:a(()=>[l(b,{modelValue:o.value.dictValue,"onUpdate:modelValue":e[6]||(e[6]=t=>o.value.dictValue=t)},null,8,["modelValue"])]),_:1}),l(d,{label:"排序",prop:"sortOrder"},{default:a(()=>[l(G,{modelValue:o.value.sortOrder,"onUpdate:modelValue":e[7]||(e[7]=t=>o.value.sortOrder=t),min:0},null,8,["modelValue"])]),_:1}),l(d,{label:"状态",prop:"status"},{default:a(()=>[l(L,{modelValue:o.value.status,"onUpdate:modelValue":e[8]||(e[8]=t=>o.value.status=t),style:{width:"100%"}},{default:a(()=>[l(C,{label:"正常",value:1}),l(C,{label:"禁用",value:0})]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"备注",prop:"remark"},{default:a(()=>[l(b,{modelValue:o.value.remark,"onUpdate:modelValue":e[9]||(e[9]=t=>o.value.remark=t),type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},ce=le(de,[["__scopeId","data-v-7e10d852"]]);export{ce as default};
