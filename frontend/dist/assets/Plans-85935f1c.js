import{s as k,r as y,b as U,j as se,k as de,c as n,v as ue,o as D,d as ie,f as e,w as t,E as g,e as P,h as p,g as I,x as pe,n as me,t as N,p as K}from"./index-9b5da449.js";import{_ as ce}from"./_plugin-vue_export-helper-c27b6911.js";const ge=i=>k({url:"/teaching-plans",method:"get",params:i}),_e=i=>k({url:"/teaching-plans",method:"post",data:i}),fe=(i,_)=>k({url:`/teaching-plans/${i}`,method:"put",data:_}),be=i=>k({url:`/teaching-plans/${i}`,method:"delete"}),ve=(i,_)=>k({url:`/teaching-plans/${i}/status`,method:"post",params:{status:_}});const ye={class:"teaching-plan-management"},Ve={class:"card-header"},he={class:"pagination"},we={__name:"Plans",setup(i){const _=y(!1),z=y(!1),v=y(!1),V=y(!1),T=y(),S=y([]),s=U({current:1,size:10,total:0}),d=U({keyword:"",deptId:null,major:"",grade:""}),o=U({id:null,planName:"",deptId:null,major:"",grade:"",totalCredits:null,description:""}),L={planName:[{required:!0,message:"请输入计划名称",trigger:"blur"}],deptId:[{required:!0,message:"请选择院系",trigger:"change"}],major:[{required:!0,message:"请输入专业",trigger:"blur"}],grade:[{required:!0,message:"请输入年级",trigger:"blur"}],totalCredits:[{required:!0,message:"请输入总学分",trigger:"blur"}]},M=se(()=>V.value?"编辑教学计划":"添加教学计划"),f=async()=>{_.value=!0;try{const r=await ge({current:s.current,size:s.size,...d});S.value=r.data.records,s.total=r.data.total}catch{g.error("获取教学计划列表失败")}finally{_.value=!1}},h=()=>{s.current=1,f()},O=()=>{Object.assign(d,{keyword:"",deptId:null,major:"",grade:""}),h()},F=()=>{V.value=!1,$(),v.value=!0},A=r=>{V.value=!0,Object.assign(o,r),v.value=!0},G=async r=>{try{await K.confirm("确定要删除该教学计划吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await be(r.id),g.success("删除成功"),f()}catch(l){l!=="cancel"&&g.error("删除失败")}},H=async r=>{const l=r.status===1?0:1,w=l===1?"启用":"禁用";try{await K.confirm(`确定要${w}该教学计划吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await ve(r.id,l),g.success(`${w}成功`),f()}catch(C){C!=="cancel"&&g.error(`${w}失败`)}},J=async()=>{T.value&&await T.value.validate(async r=>{if(r){z.value=!0;try{V.value?(await fe(o.id,o),g.success("更新成功")):(await _e(o),g.success("添加成功")),v.value=!1,f()}catch(l){g.error(l.message||"操作失败")}finally{z.value=!1}}})},Q=()=>{$()},$=()=>{Object.assign(o,{id:null,planName:"",deptId:null,major:"",grade:"",totalCredits:null,description:""})},W=r=>{s.size=r,f()},X=r=>{s.current=r,f()};return de(()=>{f()}),(r,l)=>{const w=n("Plus"),C=n("el-icon"),m=n("el-button"),b=n("el-input"),u=n("el-form-item"),x=n("el-option"),B=n("el-select"),Y=n("Search"),Z=n("Refresh"),q=n("el-form"),c=n("el-table-column"),ee=n("el-tag"),le=n("el-table"),te=n("el-pagination"),ae=n("el-card"),j=n("el-col"),E=n("el-row"),ne=n("el-input-number"),oe=n("el-dialog"),re=ue("loading");return D(),ie("div",ye,[e(ae,null,{header:t(()=>[P("div",Ve,[l[15]||(l[15]=P("span",null,"教学计划管理",-1)),e(m,{type:"primary",onClick:F},{default:t(()=>[e(C,null,{default:t(()=>[e(w)]),_:1}),l[14]||(l[14]=p(" 添加教学计划 ",-1))]),_:1})])]),default:t(()=>[e(q,{model:d,inline:"",class:"search-form"},{default:t(()=>[e(u,{label:"关键词"},{default:t(()=>[e(b,{modelValue:d.keyword,"onUpdate:modelValue":l[0]||(l[0]=a=>d.keyword=a),placeholder:"请输入计划名称、专业或年级",clearable:"",onKeyup:I(h,["enter"])},null,8,["modelValue"])]),_:1}),e(u,{label:"院系"},{default:t(()=>[e(B,{modelValue:d.deptId,"onUpdate:modelValue":l[1]||(l[1]=a=>d.deptId=a),placeholder:"请选择院系",clearable:""},{default:t(()=>[e(x,{label:"计算机学院",value:1}),e(x,{label:"软件学院",value:2})]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"专业"},{default:t(()=>[e(b,{modelValue:d.major,"onUpdate:modelValue":l[2]||(l[2]=a=>d.major=a),placeholder:"请输入专业",clearable:"",onKeyup:I(h,["enter"])},null,8,["modelValue"])]),_:1}),e(u,{label:"年级"},{default:t(()=>[e(b,{modelValue:d.grade,"onUpdate:modelValue":l[3]||(l[3]=a=>d.grade=a),placeholder:"请输入年级",clearable:"",onKeyup:I(h,["enter"])},null,8,["modelValue"])]),_:1}),e(u,null,{default:t(()=>[e(m,{type:"primary",onClick:h},{default:t(()=>[e(C,null,{default:t(()=>[e(Y)]),_:1}),l[16]||(l[16]=p(" 搜索 ",-1))]),_:1}),e(m,{onClick:O},{default:t(()=>[e(C,null,{default:t(()=>[e(Z)]),_:1}),l[17]||(l[17]=p(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"]),pe((D(),me(le,{data:S.value,stripe:"",style:{width:"100%"}},{default:t(()=>[e(c,{prop:"planName",label:"计划名称",width:"200"}),e(c,{prop:"deptName",label:"院系",width:"120"}),e(c,{prop:"major",label:"专业",width:"150"}),e(c,{prop:"grade",label:"年级",width:"100"}),e(c,{prop:"totalCredits",label:"总学分",width:"100"}),e(c,{prop:"statusText",label:"状态",width:"80"},{default:t(({row:a})=>[e(ee,{type:a.status===1?"success":"danger"},{default:t(()=>[p(N(a.statusText),1)]),_:2},1032,["type"])]),_:1}),e(c,{prop:"createTime",label:"创建时间",width:"160"}),e(c,{label:"操作",width:"200",fixed:"right"},{default:t(({row:a})=>[e(m,{type:"primary",size:"small",onClick:R=>A(a)},{default:t(()=>[...l[18]||(l[18]=[p(" 编辑 ",-1)])]),_:1},8,["onClick"]),e(m,{type:a.status===1?"warning":"success",size:"small",onClick:R=>H(a)},{default:t(()=>[p(N(a.status===1?"禁用":"启用"),1)]),_:2},1032,["type","onClick"]),e(m,{type:"danger",size:"small",onClick:R=>G(a)},{default:t(()=>[...l[19]||(l[19]=[p(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[re,_.value]]),P("div",he,[e(te,{"current-page":s.current,"onUpdate:currentPage":l[4]||(l[4]=a=>s.current=a),"page-size":s.size,"onUpdate:pageSize":l[5]||(l[5]=a=>s.size=a),total:s.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:W,onCurrentChange:X},null,8,["current-page","page-size","total"])])]),_:1}),e(oe,{modelValue:v.value,"onUpdate:modelValue":l[13]||(l[13]=a=>v.value=a),title:M.value,width:"600px",onClose:Q},{footer:t(()=>[e(m,{onClick:l[12]||(l[12]=a=>v.value=!1)},{default:t(()=>[...l[20]||(l[20]=[p("取消",-1)])]),_:1}),e(m,{type:"primary",onClick:J,loading:z.value},{default:t(()=>[p(N(V.value?"更新":"添加"),1)]),_:1},8,["loading"])]),default:t(()=>[e(q,{ref_key:"formRef",ref:T,model:o,rules:L,"label-width":"100px"},{default:t(()=>[e(u,{label:"计划名称",prop:"planName"},{default:t(()=>[e(b,{modelValue:o.planName,"onUpdate:modelValue":l[6]||(l[6]=a=>o.planName=a),placeholder:"请输入计划名称"},null,8,["modelValue"])]),_:1}),e(E,{gutter:20},{default:t(()=>[e(j,{span:12},{default:t(()=>[e(u,{label:"院系",prop:"deptId"},{default:t(()=>[e(B,{modelValue:o.deptId,"onUpdate:modelValue":l[7]||(l[7]=a=>o.deptId=a),placeholder:"请选择院系"},{default:t(()=>[e(x,{label:"计算机学院",value:1}),e(x,{label:"软件学院",value:2})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(j,{span:12},{default:t(()=>[e(u,{label:"专业",prop:"major"},{default:t(()=>[e(b,{modelValue:o.major,"onUpdate:modelValue":l[8]||(l[8]=a=>o.major=a),placeholder:"请输入专业"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(E,{gutter:20},{default:t(()=>[e(j,{span:12},{default:t(()=>[e(u,{label:"年级",prop:"grade"},{default:t(()=>[e(b,{modelValue:o.grade,"onUpdate:modelValue":l[9]||(l[9]=a=>o.grade=a),placeholder:"请输入年级"},null,8,["modelValue"])]),_:1})]),_:1}),e(j,{span:12},{default:t(()=>[e(u,{label:"总学分",prop:"totalCredits"},{default:t(()=>[e(ne,{modelValue:o.totalCredits,"onUpdate:modelValue":l[10]||(l[10]=a=>o.totalCredits=a),min:0,max:200,placeholder:"请输入总学分",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(u,{label:"计划描述",prop:"description"},{default:t(()=>[e(b,{modelValue:o.description,"onUpdate:modelValue":l[11]||(l[11]=a=>o.description=a),type:"textarea",rows:3,placeholder:"请输入计划描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},xe=ce(we,[["__scopeId","data-v-4e8878b4"]]);export{xe as default};
