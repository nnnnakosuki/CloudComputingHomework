import{a as $,r as N,b as V,j as y,k as ee,c as a,v as te,o as z,d as se,f as e,w as s,E as le,e as o,h as v,n as G,m as oe,g as ae,x as ne,t as p,y as re}from"./index-9b5da449.js";import{g as ce}from"./grade-b0111342.js";import{_ as ue}from"./_plugin-vue_export-helper-c27b6911.js";const de={class:"student-grades"},ie={class:"card-header"},_e={class:"pagination"},pe={class:"stat-content"},me={class:"stat-icon total"},fe={class:"stat-info"},ve={class:"stat-content"},he={class:"stat-icon completed"},ge={class:"stat-info"},ye={class:"stat-content"},be={class:"stat-icon gpa"},Ce={class:"stat-info"},Se={class:"stat-content"},we={class:"stat-icon credits"},xe={class:"stat-info"},Te={__name:"Grades",setup(ze){const R=$(),S=N(!1),d=N([]),c=V({current:1,size:10,total:0}),m=V({courseName:"",semester:""}),B=y(()=>d.value.length),E=y(()=>d.value.filter(l=>l.score&&l.auditStatus===2).length),F=y(()=>d.value.some(l=>l.queryStartTime&&l.queryEndTime&&(!l.score||l.auditStatusText==="查询未开放"))),U=y(()=>{const l=d.value.filter(r=>r.score&&r.auditStatus===2);if(l.length===0)return"0.0";let t=0,f=0;return l.forEach(r=>{const i=parseFloat(r.score),b=parseFloat(r.credits);let _=0;i>=90?_=4:i>=80?_=3:i>=70?_=2:i>=60?_=1:_=0,t+=_*b,f+=b}),f>0?(t/f).toFixed(2):"0.0"}),j=y(()=>d.value.reduce((l,t)=>l+(parseFloat(t.credits)||0),0)),h=async()=>{S.value=!0;try{const l=R.userInfo.id,t=await ce(l);d.value=t.data||[],c.total=d.value.length}catch{le.error("获取成绩列表失败")}finally{S.value=!1}},w=()=>{c.current=1,h()},D=()=>{Object.assign(m,{courseName:"",semester:""}),w()},I=l=>{c.size=l,h()},q=l=>{c.current=l,h()},K=l=>l?l>=90?"score-excellent":l>=80?"score-good":l>=70?"score-medium":l>=60?"score-pass":"score-fail":"score-empty",L=l=>{switch(l){case 1:return"warning";case 2:return"success";case 3:return"danger";default:return"info"}};return ee(()=>{h()}),(l,t)=>{const f=a("Refresh"),r=a("el-icon"),i=a("el-button"),b=a("el-alert"),_=a("el-input"),x=a("el-form-item"),T=a("el-option"),M=a("el-select"),P=a("Search"),A=a("el-form"),u=a("el-table-column"),k=a("el-tag"),O=a("el-table"),H=a("el-pagination"),g=a("el-card"),J=a("Reading"),C=a("el-col"),Q=a("Check"),W=a("TrendCharts"),X=a("Trophy"),Y=a("el-row"),Z=te("loading");return z(),se("div",de,[e(g,null,{header:s(()=>[o("div",ie,[t[5]||(t[5]=o("span",null,"我的成绩",-1)),e(i,{onClick:h},{default:s(()=>[e(r,null,{default:s(()=>[e(f)]),_:1}),t[4]||(t[4]=v(" 刷新 ",-1))]),_:1})])]),default:s(()=>[F.value?(z(),G(b,{key:0,title:"部分成绩暂未开放查询",type:"warning",closable:!1,style:{"margin-bottom":"20px"}},{default:s(()=>[...t[6]||(t[6]=[v(" 部分课程的成绩查询时段尚未开放，请在开放时段内查询成绩。 ",-1)])]),_:1})):oe("",!0),e(A,{model:m,inline:"",class:"search-form"},{default:s(()=>[e(x,{label:"课程名称"},{default:s(()=>[e(_,{modelValue:m.courseName,"onUpdate:modelValue":t[0]||(t[0]=n=>m.courseName=n),placeholder:"请输入课程名称",clearable:"",onKeyup:ae(w,["enter"])},null,8,["modelValue"])]),_:1}),e(x,{label:"学期"},{default:s(()=>[e(M,{modelValue:m.semester,"onUpdate:modelValue":t[1]||(t[1]=n=>m.semester=n),placeholder:"请选择学期",clearable:"",style:{width:"150px"}},{default:s(()=>[e(T,{label:"2024春季",value:"2024春季"}),e(T,{label:"2023秋季",value:"2023秋季"}),e(T,{label:"2023春季",value:"2023春季"})]),_:1},8,["modelValue"])]),_:1}),e(x,null,{default:s(()=>[e(i,{type:"primary",onClick:w},{default:s(()=>[e(r,null,{default:s(()=>[e(P)]),_:1}),t[7]||(t[7]=v(" 搜索 ",-1))]),_:1}),e(i,{onClick:D},{default:s(()=>[e(r,null,{default:s(()=>[e(f)]),_:1}),t[8]||(t[8]=v(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"]),ne((z(),G(O,{data:d.value,stripe:"",style:{width:"100%"}},{default:s(()=>[e(u,{prop:"courseCode",label:"课程编号",width:"120"}),e(u,{prop:"courseName",label:"课程名称",width:"150"}),e(u,{prop:"credits",label:"学分",width:"80"}),e(u,{prop:"courseType",label:"课程类型",width:"100"},{default:s(({row:n})=>[e(k,{type:n.courseType===1?"primary":"success"},{default:s(()=>[v(p(n.courseType===1?"必修":"选修"),1)]),_:2},1032,["type"])]),_:1}),e(u,{prop:"score",label:"成绩",width:"100"},{default:s(({row:n})=>[o("span",{class:re(K(n.score))},p(n.score||"未录入"),3)]),_:1}),e(u,{prop:"teacherName",label:"任课教师",width:"100"}),e(u,{prop:"semester",label:"学期",width:"120"}),e(u,{prop:"auditStatusText",label:"审核状态",width:"100"},{default:s(({row:n})=>[e(k,{type:L(n.auditStatus)},{default:s(()=>[v(p(n.auditStatusText||"未审核"),1)]),_:2},1032,["type"])]),_:1}),e(u,{prop:"submitTime",label:"提交时间",width:"160"})]),_:1},8,["data"])),[[Z,S.value]]),o("div",_e,[e(H,{"current-page":c.current,"onUpdate:currentPage":t[2]||(t[2]=n=>c.current=n),"page-size":c.size,"onUpdate:pageSize":t[3]||(t[3]=n=>c.size=n),total:c.total,"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:I,onCurrentChange:q},null,8,["current-page","page-size","total"])])]),_:1}),e(Y,{gutter:20,style:{"margin-top":"20px"}},{default:s(()=>[e(C,{span:6},{default:s(()=>[e(g,{class:"stat-card"},{default:s(()=>[o("div",pe,[o("div",me,[e(r,null,{default:s(()=>[e(J)]),_:1})]),o("div",fe,[o("h3",null,p(B.value),1),t[9]||(t[9]=o("p",null,"总课程数",-1))])])]),_:1})]),_:1}),e(C,{span:6},{default:s(()=>[e(g,{class:"stat-card"},{default:s(()=>[o("div",ve,[o("div",he,[e(r,null,{default:s(()=>[e(Q)]),_:1})]),o("div",ge,[o("h3",null,p(E.value),1),t[10]||(t[10]=o("p",null,"已完成",-1))])])]),_:1})]),_:1}),e(C,{span:6},{default:s(()=>[e(g,{class:"stat-card"},{default:s(()=>[o("div",ye,[o("div",be,[e(r,null,{default:s(()=>[e(W)]),_:1})]),o("div",Ce,[o("h3",null,p(U.value),1),t[11]||(t[11]=o("p",null,"平均绩点",-1))])])]),_:1})]),_:1}),e(C,{span:6},{default:s(()=>[e(g,{class:"stat-card"},{default:s(()=>[o("div",Se,[o("div",we,[e(r,null,{default:s(()=>[e(X)]),_:1})]),o("div",xe,[o("h3",null,p(j.value),1),t[12]||(t[12]=o("p",null,"总学分",-1))])])]),_:1})]),_:1})]),_:1})])}}},Ge=ue(Te,[["__scopeId","data-v-a48014c9"]]);export{Ge as default};
