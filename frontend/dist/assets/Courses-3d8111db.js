import{r as y,b as I,j as oe,k as se,c as o,v as ne,o as q,d as re,f as e,w as t,E as _,e as N,h as d,g as ue,x as de,n as ie,t as x,p as D}from"./index-9b5da449.js";import{a as pe,d as ce,c as me,u as _e,b as fe}from"./course-935a4045.js";import{_ as ge}from"./_plugin-vue_export-helper-c27b6911.js";const ye={class:"course-management"},ve={class:"card-header"},be={class:"pagination"},Ce={__name:"Courses",setup(Ve){const h=y(!1),k=y(!1),g=y(!1),v=y(!1),S=y([]),r=I({current:1,size:10,total:0}),i=I({keyword:"",deptId:null,courseType:null}),s=I({id:null,courseCode:"",courseName:"",credits:null,courseType:null,deptId:null,description:""}),L={courseCode:[{required:!0,message:"请输入课程编号",trigger:"blur"}],courseName:[{required:!0,message:"请输入课程名称",trigger:"blur"}],credits:[{required:!0,message:"请输入学分",trigger:"blur"}],courseType:[{required:!0,message:"请选择课程类型",trigger:"change"}],deptId:[{required:!0,message:"请选择开课院系",trigger:"change"}]},M=oe(()=>v.value?"编辑课程":"添加课程"),f=async()=>{h.value=!0;try{const n=await pe({current:r.current,size:r.size,...i});S.value=n.data.records,r.total=n.data.total}catch{_.error("获取课程列表失败")}finally{h.value=!1}},z=()=>{r.current=1,f()},O=()=>{Object.assign(i,{keyword:"",deptId:null,courseType:null}),z()},P=()=>{v.value=!1,B(),g.value=!0},F=n=>{v.value=!0,Object.assign(s,n),g.value=!0},K=async n=>{try{await D.confirm("确定要删除该课程吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await ce(n.id),_.success("删除成功"),f()}catch(l){l!=="cancel"&&_.error("删除失败")}},A=async n=>{const l=n.status===1?0:1,b=l===1?"启用":"禁用";try{await D.confirm(`确定要${b}该课程吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await me(n.id,l),_.success(`${b}成功`),f()}catch(C){C!=="cancel"&&_.error(`${b}失败`)}},U=y(),G=async()=>{U.value&&await U.value.validate(async n=>{if(n){k.value=!0;try{v.value?(await _e(s.id,s),_.success("更新成功")):(await fe(s),_.success("添加成功")),g.value=!1,f()}catch(l){_.error(l.message||"操作失败")}finally{k.value=!1}}})},H=()=>{B()},B=()=>{Object.assign(s,{id:null,courseCode:"",courseName:"",credits:null,courseType:null,deptId:null,description:""})},J=n=>{r.size=n,f()},Q=n=>{r.current=n,f()};return se(()=>{f()}),(n,l)=>{const b=o("Plus"),C=o("el-icon"),p=o("el-button"),V=o("el-input"),u=o("el-form-item"),c=o("el-option"),w=o("el-select"),W=o("Search"),X=o("Refresh"),$=o("el-form"),m=o("el-table-column"),E=o("el-tag"),Y=o("el-table"),Z=o("el-pagination"),ee=o("el-card"),T=o("el-col"),R=o("el-row"),le=o("el-input-number"),te=o("el-dialog"),ae=ne("loading");return q(),re("div",ye,[e(ee,null,{header:t(()=>[N("div",ve,[l[14]||(l[14]=N("span",null,"课程管理",-1)),e(p,{type:"primary",onClick:P},{default:t(()=>[e(C,null,{default:t(()=>[e(b)]),_:1}),l[13]||(l[13]=d(" 添加课程 ",-1))]),_:1})])]),default:t(()=>[e($,{model:i,inline:"",class:"search-form"},{default:t(()=>[e(u,{label:"关键词"},{default:t(()=>[e(V,{modelValue:i.keyword,"onUpdate:modelValue":l[0]||(l[0]=a=>i.keyword=a),placeholder:"请输入课程编号或课程名称",clearable:"",onKeyup:ue(z,["enter"])},null,8,["modelValue"])]),_:1}),e(u,{label:"院系"},{default:t(()=>[e(w,{modelValue:i.deptId,"onUpdate:modelValue":l[1]||(l[1]=a=>i.deptId=a),placeholder:"请选择院系",clearable:""},{default:t(()=>[e(c,{label:"计算机学院",value:1}),e(c,{label:"软件学院",value:2})]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"课程类型"},{default:t(()=>[e(w,{modelValue:i.courseType,"onUpdate:modelValue":l[2]||(l[2]=a=>i.courseType=a),placeholder:"请选择课程类型",clearable:""},{default:t(()=>[e(c,{label:"必修",value:1}),e(c,{label:"选修",value:2})]),_:1},8,["modelValue"])]),_:1}),e(u,null,{default:t(()=>[e(p,{type:"primary",onClick:z},{default:t(()=>[e(C,null,{default:t(()=>[e(W)]),_:1}),l[15]||(l[15]=d(" 搜索 ",-1))]),_:1}),e(p,{onClick:O},{default:t(()=>[e(C,null,{default:t(()=>[e(X)]),_:1}),l[16]||(l[16]=d(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"]),de((q(),ie(Y,{data:S.value,stripe:"",style:{width:"100%"}},{default:t(()=>[e(m,{prop:"courseCode",label:"课程编号",width:"120"}),e(m,{prop:"courseName",label:"课程名称",width:"200"}),e(m,{prop:"credits",label:"学分",width:"80"}),e(m,{prop:"courseTypeText",label:"课程类型",width:"100"},{default:t(({row:a})=>[e(E,{type:a.courseType===1?"primary":"success"},{default:t(()=>[d(x(a.courseTypeText),1)]),_:2},1032,["type"])]),_:1}),e(m,{prop:"deptName",label:"开课院系",width:"120"}),e(m,{prop:"statusText",label:"状态",width:"80"},{default:t(({row:a})=>[e(E,{type:a.status===1?"success":"danger"},{default:t(()=>[d(x(a.statusText),1)]),_:2},1032,["type"])]),_:1}),e(m,{prop:"createTime",label:"创建时间",width:"160"}),e(m,{label:"操作",width:"200",fixed:"right"},{default:t(({row:a})=>[e(p,{type:"primary",size:"small",onClick:j=>F(a)},{default:t(()=>[...l[17]||(l[17]=[d(" 编辑 ",-1)])]),_:1},8,["onClick"]),e(p,{type:a.status===1?"warning":"success",size:"small",onClick:j=>A(a)},{default:t(()=>[d(x(a.status===1?"禁用":"启用"),1)]),_:2},1032,["type","onClick"]),e(p,{type:"danger",size:"small",onClick:j=>K(a)},{default:t(()=>[...l[18]||(l[18]=[d(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ae,h.value]]),N("div",be,[e(Z,{"current-page":r.current,"onUpdate:currentPage":l[3]||(l[3]=a=>r.current=a),"page-size":r.size,"onUpdate:pageSize":l[4]||(l[4]=a=>r.size=a),total:r.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:J,onCurrentChange:Q},null,8,["current-page","page-size","total"])])]),_:1}),e(te,{modelValue:g.value,"onUpdate:modelValue":l[12]||(l[12]=a=>g.value=a),title:M.value,width:"600px",onClose:H},{footer:t(()=>[e(p,{onClick:l[11]||(l[11]=a=>g.value=!1)},{default:t(()=>[...l[19]||(l[19]=[d("取消",-1)])]),_:1}),e(p,{type:"primary",onClick:G,loading:k.value},{default:t(()=>[d(x(v.value?"更新":"添加"),1)]),_:1},8,["loading"])]),default:t(()=>[e($,{ref_key:"formRef",ref:U,model:s,rules:L,"label-width":"100px"},{default:t(()=>[e(R,{gutter:20},{default:t(()=>[e(T,{span:12},{default:t(()=>[e(u,{label:"课程编号",prop:"courseCode"},{default:t(()=>[e(V,{modelValue:s.courseCode,"onUpdate:modelValue":l[5]||(l[5]=a=>s.courseCode=a),placeholder:"请输入课程编号"},null,8,["modelValue"])]),_:1})]),_:1}),e(T,{span:12},{default:t(()=>[e(u,{label:"课程名称",prop:"courseName"},{default:t(()=>[e(V,{modelValue:s.courseName,"onUpdate:modelValue":l[6]||(l[6]=a=>s.courseName=a),placeholder:"请输入课程名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(R,{gutter:20},{default:t(()=>[e(T,{span:12},{default:t(()=>[e(u,{label:"学分",prop:"credits"},{default:t(()=>[e(le,{modelValue:s.credits,"onUpdate:modelValue":l[7]||(l[7]=a=>s.credits=a),min:.5,max:10,step:.5,placeholder:"请输入学分",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(T,{span:12},{default:t(()=>[e(u,{label:"课程类型",prop:"courseType"},{default:t(()=>[e(w,{modelValue:s.courseType,"onUpdate:modelValue":l[8]||(l[8]=a=>s.courseType=a),placeholder:"请选择课程类型"},{default:t(()=>[e(c,{label:"必修",value:1}),e(c,{label:"选修",value:2})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(u,{label:"开课院系",prop:"deptId"},{default:t(()=>[e(w,{modelValue:s.deptId,"onUpdate:modelValue":l[9]||(l[9]=a=>s.deptId=a),placeholder:"请选择开课院系"},{default:t(()=>[e(c,{label:"计算机学院",value:1}),e(c,{label:"软件学院",value:2})]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"课程描述",prop:"description"},{default:t(()=>[e(V,{modelValue:s.description,"onUpdate:modelValue":l[10]||(l[10]=a=>s.description=a),type:"textarea",rows:3,placeholder:"请输入课程描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},he=ge(Ce,[["__scopeId","data-v-3e045379"]]);export{he as default};
